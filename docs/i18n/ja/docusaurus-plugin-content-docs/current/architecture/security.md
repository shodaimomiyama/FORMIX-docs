---
sidebar_position: 3
---

# セキュリティ特性

FORMIXは閾値プロキシ再暗号化スキームにより、強力な暗号保証を提供します。

## コアセキュリティ特性

### IND-CPAセキュリティ

FORMIXは**選択平文攻撃に対する識別不能性（IND-CPA）**を達成しています。これは：

- 攻撃者が2つの異なるメッセージの暗号化を区別できない
- 暗号化オラクルにアクセスしても、暗号文は平文について何も明らかにしない
- セキュリティは決定Diffie-Hellman（DDH）問題の困難性に依存

```
与えられた: (G, g^a, g^b, g^c)
判定困難: c = ab mod q か？
```

### 閾値耐障害性

システムは閾値限界までのビザンチン障害を許容します：

| 設定 | 耐性 |
|--------------|-----------|
| (3, 5) | 2つの悪意/障害ノード |
| (5, 9) | 4つの悪意/障害ノード |
| (t, n) | n - t の障害 |

**特性**:
- 任意の`t`個の正直なノードが再暗号化を完了可能
- `t`未満のノードは秘密について何も知り得ない
- 単一障害点なし

### 共謀耐性

複数の当事者が共謀しても、以下は不可能：

1. **プロキシ + Requester共謀**: Owner認可なしには復号不可
2. **プロキシ + プロキシ共謀**: 閾値未満のプロキシでは再暗号化鍵を再構築不可
3. **Owner + Requester共謀**: データは保存時も暗号化されたまま

## 暗号プリミティブ

### 楕円曲線暗号

FORMIXは**BLS12-381**曲線を使用し、以下を提供：

- 約128ビットセキュリティレベル
- 効率的なペアリング操作
- 小さな鍵/署名サイズ

```
セキュリティレベル: 128ビット
G1ポイントサイズ: 48バイト
G2ポイントサイズ: 96バイト
```

### 鍵カプセル化

カプセルはハイブリッド暗号を使用して対称鍵をカプセル化します：

```
1. ランダムrを生成
2. E = r * G（生成点）を計算
3. V = r * pk_ownerを計算
4. 対称鍵 = H(r * pk_owner)を導出
5. Capsule = (E, V, signature)
```

### 再暗号化鍵生成

KFragはShamirの秘密分散の変種を使用して生成：

```
1. 次数t-1のランダム多項式f(x)を選択
2. f(0) = sk_owner * sk_requester^(-1) [概念的に]
3. KFrag_i = f(i) for i = 1, ..., n
4. 各KFragは正しさの証明を含む
```

## 攻撃耐性

### リプレイ攻撃

- 各カプセルには一意の識別子が含まれる
- 再暗号化要求はノンスで追跡
- 重複要求は拒否

### 中間者攻撃

- すべての通信は認証済み
- KFragは発信元検証を含む
- CFragはRequesterに暗号的にバインド

### 鍵抽出

- 秘密鍵はそれぞれのプロセスから外に出ない
- 再暗号化は鍵を露出せずに行われる
- プロキシは暗号化された鍵材料のみを見る

## セキュリティ前提

FORMIXのセキュリティは以下に依存：

1. **DDH仮定**: G1において決定Diffie-Hellmanは困難
2. **ランダムオラクルモデル**: ハッシュ関数はランダムオラクルとして振る舞う
3. **閾値仮定**: `t`未満のプロキシが侵害される
4. **AOセキュリティ**: AO Networkはプロセス分離を提供

## 脅威モデル

### 対象範囲内

| 脅威 | 緩和策 |
|--------|------------|
| 盗聴 | エンドツーエンド暗号化 |
| プロキシ侵害（< t） | 閾値分散 |
| ストレージ侵害 | 保存時データ暗号化 |
| リプレイ攻撃 | ノンスベースの要求追跡 |

### 対象範囲外

- クライアントデバイスへのサイドチャネル攻撃
- ソーシャルエンジニアリング攻撃
- t個以上のプロキシノードの侵害
- AO Networkコンセンサス攻撃

## ベストプラクティス

### 閾値選択

```
推奨設定:
- 低セキュリティ:  (2, 3)  - 高速、冗長性低
- 中程度:          (3, 5)  - バランス型
- 高セキュリティ:  (5, 9)  - 最大耐性
```

### 鍵管理

1. **秘密鍵を決して共有しない**
2. **KFragを定期的にローテーション**
3. **本番環境ではハードウェアセキュリティモジュールを使用**
4. **安全な鍵バックアップ手順を維持**

### 運用セキュリティ

1. **プロキシノードの健全性を監視**
2. **アクセスログを実装**
3. **定期的なセキュリティ監査**
4. **インシデント対応計画**

## 形式検証

暗号プリミティブは査読済み研究に基づいています：

- Blaze et al. "Divertible Protocols and Atomic Proxy Cryptography"
- Ateniese et al. "Improved Proxy Re-Encryption Schemes"
- NuCypher "Umbral: A Threshold Proxy Re-Encryption Scheme"

## 次のステップ

- [APIリファレンス](/docs/api/actions-api) - 実装詳細
- [開発ガイド](/docs/development/project-structure) - コード構成
